"use strict";(self.webpackChunkmif_docs=self.webpackChunkmif_docs||[]).push([[174],{8916(e,t,l){l.r(t),l.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>o,frontMatter:()=>d,metadata:()=>i,toc:()=>x});const i=JSON.parse('{"id":"reference/heimdall/plugin","title":"Heimdall Plugin","description":"Profile Handlers","source":"@site/docs/reference/heimdall/plugin.mdx","sourceDirName":"reference/heimdall","slug":"/reference/heimdall/plugin","permalink":"/dev/reference/heimdall/plugin","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Heimdall Plugin","sidebar_label":"Plugin","sidebar_position":2},"sidebar":"docs","previous":{"title":"API Reference","permalink":"/dev/reference/heimdall/api-reference"},"next":{"title":"API Reference","permalink":"/dev/reference/odin/api-reference"}}');var s=l(4848),n=l(8453);const d={title:"Heimdall Plugin",sidebar_label:"Plugin",sidebar_position:2},r=void 0,c={},x=[{value:"Profile Handlers",id:"profile-handlers",level:2},{value:"<code>single-profile-handler</code>",id:"single-profile-handler",level:3},{value:"<code>pd-profile-handler</code>",id:"pd-profile-handler",level:3},{value:"Filters",id:"filters",level:2},{value:"<code>by-label</code>",id:"by-label",level:3},{value:"<code>by-label-selector</code>",id:"by-label-selector",level:3},{value:"<code>prefill-filter</code>",id:"prefill-filter",level:3},{value:"<code>decode-filter</code>",id:"decode-filter",level:3},{value:"Scorers",id:"scorers",level:2},{value:"<code>active-request-scorer</code>",id:"active-request-scorer",level:3},{value:"<code>load-aware-scorer</code>",id:"load-aware-scorer",level:3},{value:"<code>no-hit-lru-scorer</code>",id:"no-hit-lru-scorer",level:3},{value:"<code>precise-prefix-cache-scorer</code>",id:"precise-prefix-cache-scorer",level:3},{value:"<code>tokenProcessorConfig</code>",id:"tokenprocessorconfig",level:4},{value:"<code>indexerConfig</code>",id:"indexerconfig",level:4},{value:"<code>kvBlockIndexConfig</code>",id:"kvblockindexconfig",level:4},{value:"<code>inMemoryConfig</code>",id:"inmemoryconfig",level:5},{value:"<code>redisConfig</code> / <code>valkeyConfig</code>",id:"redisconfig--valkeyconfig",level:5},{value:"<code>costAwareMemoryConfig</code>",id:"costawarememoryconfig",level:5},{value:"<code>tokenizersPoolConfig</code>",id:"tokenizerspoolconfig",level:4},{value:"<code>hf</code> (HuggingFace Tokenizer)",id:"hf-huggingface-tokenizer",level:5},{value:"<code>local</code> (Local Tokenizer)",id:"local-local-tokenizer",level:5},{value:"<code>uds</code> (UDS Tokenizer)",id:"uds-uds-tokenizer",level:5},{value:"<code>kvEventsConfig</code>",id:"kveventsconfig",level:4},{value:"<code>podDiscoveryConfig</code>",id:"poddiscoveryconfig",level:5},{value:"<code>session-affinity-scorer</code>",id:"session-affinity-scorer",level:3},{value:"<code>kv-cache-utilization-scorer</code>",id:"kv-cache-utilization-scorer",level:3},{value:"<code>lora-affinity-scorer</code>",id:"lora-affinity-scorer",level:3},{value:"<code>queue-scorer</code>",id:"queue-scorer",level:3},{value:"<code>running-requests-size-scorer</code>",id:"running-requests-size-scorer",level:3},{value:"<code>prefix-cache-scorer</code>",id:"prefix-cache-scorer",level:3},{value:"Pickers",id:"pickers",level:2},{value:"<code>max-score-picker</code>",id:"max-score-picker",level:3},{value:"<code>random-picker</code>",id:"random-picker",level:3},{value:"<code>weighted-random-picker</code>",id:"weighted-random-picker",level:3},{value:"Response Plugins",id:"response-plugins",level:2},{value:"<code>response-header-handler</code>",id:"response-header-handler",level:3}];function h(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",h5:"h5",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"profile-handlers",children:"Profile Handlers"}),"\n",(0,s.jsx)(t.h3,{id:"single-profile-handler",children:(0,s.jsx)(t.code,{children:"single-profile-handler"})}),"\n",(0,s.jsx)(t.p,{children:"Handles a single profile which is always the primary profile."}),"\n",(0,s.jsx)(t.p,{children:"No parameters."}),"\n",(0,s.jsx)(t.h3,{id:"pd-profile-handler",children:(0,s.jsx)(t.code,{children:"pd-profile-handler"})}),"\n",(0,s.jsx)(t.p,{children:"Handles scheduler profiles for Prefill-Decode (PD) disaggregation."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"threshold"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"0"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Threshold for decoding operations."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"decodeProfile"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"decode"'})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Name of the profile to use for decode operations."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"prefillProfile"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"prefill"'})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Name of the profile to use for prefill operations."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"prefixPluginType"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"prefix-cache-scorer"'})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Type of the prefix cache plugin to use."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"prefixPluginName"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"prefix-cache-scorer"'})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Name of the prefix cache plugin to use."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"hashBlockSize"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"64"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Block size used for hashing tokens."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"primaryPort"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"0"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Port number of the primary container (0 to disable)."})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"filters",children:"Filters"}),"\n",(0,s.jsx)(t.h3,{id:"by-label",children:(0,s.jsx)(t.code,{children:"by-label"})}),"\n",(0,s.jsx)(t.p,{children:"Filters out pods based on the values defined by the given label."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"label"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"The label key to filter by. (Required)"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"validValues"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"[]string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["List of allowed values for the label. (Required unless ",(0,s.jsx)(t.code,{children:"allowsNoLabel"})," is true)"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"allowsNoLabel"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"bool"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"false"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Whether to allow pods that do not have the specified label."})]})]})]}),"\n",(0,s.jsx)(t.h3,{id:"by-label-selector",children:(0,s.jsx)(t.code,{children:"by-label-selector"})}),"\n",(0,s.jsx)(t.p,{children:"Filters out pods that do not match the configured label selector criteria."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"matchLabels"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"map[string]string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Key-value pairs of labels that must match."})]})})]}),"\n",(0,s.jsx)(t.h3,{id:"prefill-filter",children:(0,s.jsx)(t.code,{children:"prefill-filter"})}),"\n",(0,s.jsxs)(t.p,{children:["Filters for pods designated with the ",(0,s.jsx)(t.code,{children:"prefill"})," role. It retains pods that have the label ",(0,s.jsx)(t.code,{children:"mif.moreh.io/role"})," set to ",(0,s.jsx)(t.code,{children:"prefill"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"No parameters."}),"\n",(0,s.jsx)(t.h3,{id:"decode-filter",children:(0,s.jsx)(t.code,{children:"decode-filter"})}),"\n",(0,s.jsxs)(t.p,{children:["Filters for pods designated with the ",(0,s.jsx)(t.code,{children:"decode"})," role. It retains pods that satisfy one of the following conditions:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["The label ",(0,s.jsx)(t.code,{children:"mif.moreh.io/role"})," is set to ",(0,s.jsx)(t.code,{children:"decode"})," or ",(0,s.jsx)(t.code,{children:"both"}),"."]}),"\n",(0,s.jsxs)(t.li,{children:["The label ",(0,s.jsx)(t.code,{children:"mif.moreh.io/role"})," is not set."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"No parameters."}),"\n",(0,s.jsx)(t.h2,{id:"scorers",children:"Scorers"}),"\n",(0,s.jsx)(t.h3,{id:"active-request-scorer",children:(0,s.jsx)(t.code,{children:"active-request-scorer"})}),"\n",(0,s.jsx)(t.p,{children:"Scores pods based on the number of active requests being served. Scores are normalized from 0 to 1."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"requestTimeout"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"2m"'})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:'Duration to consider a request active (e.g., "30s", "1m").'})]})})]}),"\n",(0,s.jsx)(t.h3,{id:"load-aware-scorer",children:(0,s.jsx)(t.code,{children:"load-aware-scorer"})}),"\n",(0,s.jsx)(t.p,{children:"Scores pods based on load (waiting queue size). Pods with empty queues get higher scores."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"threshold"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"128"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Queue size threshold for scoring."})]})})]}),"\n",(0,s.jsx)(t.h3,{id:"no-hit-lru-scorer",children:(0,s.jsx)(t.code,{children:"no-hit-lru-scorer"})}),"\n",(0,s.jsx)(t.p,{children:"Favors pods that were least recently used for cold requests to distribute cache growth."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"prefixPluginType"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"prefix-cache-scorer"'})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Type of the prefix cache plugin."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"prefixPluginName"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"prefix-cache-scorer"'})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Name of the prefix cache plugin."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"lruSize"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"1024"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Size of the LRU cache."})]})]})]}),"\n",(0,s.jsx)(t.h3,{id:"precise-prefix-cache-scorer",children:(0,s.jsx)(t.code,{children:"precise-prefix-cache-scorer"})}),"\n",(0,s.jsx)(t.p,{children:"Scores pods based on precise prefix-cache KV-block locality using an internal indexer."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"tokenProcessorConfig"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.a,{href:"#tokenprocessorconfig",children:(0,s.jsx)(t.code,{children:"Object"})})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Configuration for the token processor."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"indexerConfig"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.a,{href:"#indexerconfig",children:(0,s.jsx)(t.code,{children:"Object"})})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Configuration for the KV cache indexer."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"kvEventsConfig"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.a,{href:"#kveventsconfig",children:(0,s.jsx)(t.code,{children:"Object"})})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Configuration for KV events subscription."})]})]})]}),"\n",(0,s.jsx)(t.h4,{id:"tokenprocessorconfig",children:(0,s.jsx)(t.code,{children:"tokenProcessorConfig"})}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"blockSize"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"16"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Number of tokens per block."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"hashSeed"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'""'})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Seed for computing block hashes. Should match ",(0,s.jsx)(t.code,{children:"PYTHONHASHSEED"}),"."]})]})]})]}),"\n",(0,s.jsx)(t.h4,{id:"indexerconfig",children:(0,s.jsx)(t.code,{children:"indexerConfig"})}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"kvBlockIndexConfig"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.a,{href:"#kvblockindexconfig",children:(0,s.jsx)(t.code,{children:"Object"})})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Configuration for the KV-block index backend."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"tokenizersPoolConfig"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.a,{href:"#tokenizerspoolconfig",children:(0,s.jsx)(t.code,{children:"Object"})})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Configuration for the tokenizers pool."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"enableMetrics"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"bool"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"false"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Whether to enable metrics for the indexer."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"metricsLoggingInterval"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"0s"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:'Interval for logging metrics (e.g., "10s").'})]})]})]}),"\n",(0,s.jsx)(t.h4,{id:"kvblockindexconfig",children:(0,s.jsx)(t.code,{children:"kvBlockIndexConfig"})}),"\n",(0,s.jsx)(t.p,{children:"Only one of the following backends should be configured."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"inMemoryConfig"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.a,{href:"#inmemoryconfig",children:(0,s.jsx)(t.code,{children:"Object"})})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Configuration for in-memory index."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"redisConfig"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.a,{href:"#redisconfig--valkeyconfig",children:(0,s.jsx)(t.code,{children:"Object"})})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Configuration for Redis index."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"valkeyConfig"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.a,{href:"#redisconfig--valkeyconfig",children:(0,s.jsx)(t.code,{children:"Object"})})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Configuration for Valkey index."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"costAwareMemoryConfig"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.a,{href:"#costawarememoryconfig",children:(0,s.jsx)(t.code,{children:"Object"})})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Configuration for cost-aware memory index."})]})]})]}),"\n",(0,s.jsx)(t.h5,{id:"inmemoryconfig",children:(0,s.jsx)(t.code,{children:"inMemoryConfig"})}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"size"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"1e8"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Maximum number of keys in the index."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"podCacheSize"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"10"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Maximum number of pod entries per key."})]})]})]}),"\n",(0,s.jsxs)(t.h5,{id:"redisconfig--valkeyconfig",children:[(0,s.jsx)(t.code,{children:"redisConfig"})," / ",(0,s.jsx)(t.code,{children:"valkeyConfig"})]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"address"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"redis://127.0.0.1:6379"'})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Address of the Redis/Valkey server."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"backendType"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"redis"'})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:'Backend type ("redis" or "valkey").'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"enableRDMA"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"bool"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"false"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Enable RDMA (experimental, Valkey only)."})]})]})]}),"\n",(0,s.jsx)(t.h5,{id:"costawarememoryconfig",children:(0,s.jsx)(t.code,{children:"costAwareMemoryConfig"})}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"size"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"2GiB"'})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:'Maximum memory size (e.g., "2GiB", "500MiB").'})]})})]}),"\n",(0,s.jsx)(t.h4,{id:"tokenizerspoolconfig",children:(0,s.jsx)(t.code,{children:"tokenizersPoolConfig"})}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"modelName"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Base model name for the tokenizer. (Required)"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"workersCount"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"5"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Number of concurrent tokenizer workers."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"hf"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.a,{href:"#hf-huggingface-tokenizer",children:(0,s.jsx)(t.code,{children:"Object"})})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Configuration for HuggingFace tokenizer."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"local"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.a,{href:"#local-local-tokenizer",children:(0,s.jsx)(t.code,{children:"Object"})})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Configuration for local tokenizer."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"uds"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.a,{href:"#uds-uds-tokenizer",children:(0,s.jsx)(t.code,{children:"Object"})})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Configuration for UDS-based tokenizer."})]})]})]}),"\n",(0,s.jsxs)(t.h5,{id:"hf-huggingface-tokenizer",children:[(0,s.jsx)(t.code,{children:"hf"})," (HuggingFace Tokenizer)"]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"enabled"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"bool"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"true"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Enable HuggingFace tokenizer."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"huggingFaceToken"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'""'})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"HuggingFace API token."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"tokenizersCacheDir"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"bin"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Directory to cache downloaded tokenizers."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"tokenizer"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'""'})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Specific tokenizer to use (defaults to model name)."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"tokenizerMode"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"auto"'})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:'Tokenizer mode ("auto", "hf", "limit", "mistral").'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"tokenizerRevision"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'""'})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Revision of the tokenizer."})]})]})]}),"\n",(0,s.jsxs)(t.h5,{id:"local-local-tokenizer",children:[(0,s.jsx)(t.code,{children:"local"})," (Local Tokenizer)"]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"autoDiscoveryDir"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"/mnt/models"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Directory to search for tokenizers."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"autoDiscoveryTokenizerFileName"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"tokenizer.json"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Filename to search for."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"modelTokenizerMap"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"map[string]string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Manual mapping of model names to tokenizer paths."})]})]})]}),"\n",(0,s.jsxs)(t.h5,{id:"uds-uds-tokenizer",children:[(0,s.jsx)(t.code,{children:"uds"})," (UDS Tokenizer)"]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"socketFile"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"/tmp/tokenizer/tokenizer-uds.socket"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Path to the UDS socket file."})]})})]}),"\n",(0,s.jsx)(t.h4,{id:"kveventsconfig",children:(0,s.jsx)(t.code,{children:"kvEventsConfig"})}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"zmqEndpoint"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:'ZMQ endpoint to connect to (e.g., "tcp://indexer:5557").'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"topicFilter"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"kv@"'})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"ZMQ topic filter subscription."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"concurrency"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"4"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Number of event processing workers."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"discoverPods"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"bool"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"true"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Enable automatic pod discovery."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"podDiscoveryConfig"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.a,{href:"#poddiscoveryconfig",children:(0,s.jsx)(t.code,{children:"Object"})})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Configuration for pod discovery."})]})]})]}),"\n",(0,s.jsx)(t.h5,{id:"poddiscoveryconfig",children:(0,s.jsx)(t.code,{children:"podDiscoveryConfig"})}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"podLabelSelector"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"llm-d.ai/inferenceServing=true"'})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Label selector to find pods."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"podNamespace"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'""'})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Namespace to watch pods in (empty = all)."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"socketPort"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"5557"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Port where pods expose their ZMQ socket."})]})]})]}),"\n",(0,s.jsx)(t.h3,{id:"session-affinity-scorer",children:(0,s.jsx)(t.code,{children:"session-affinity-scorer"})}),"\n",(0,s.jsx)(t.p,{children:"Routes subsequent requests in a session to the same pod as the first request."}),"\n",(0,s.jsxs)(t.p,{children:["This scorer relies on the ",(0,s.jsx)(t.code,{children:"x-session-token"})," HTTP header to maintain session affinity:"]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Response:"})," When a request is served, the plugin sets the ",(0,s.jsx)(t.code,{children:"x-session-token"})," header in the response with the Base64-encoded name of the serving pod."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Request:"})," For subsequent requests, the client must include this ",(0,s.jsx)(t.code,{children:"x-session-token"})," header. The scorer decodes it to identify the target pod and assigns it a high score."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"No parameters."}),"\n",(0,s.jsx)(t.h3,{id:"kv-cache-utilization-scorer",children:(0,s.jsx)(t.code,{children:"kv-cache-utilization-scorer"})}),"\n",(0,s.jsx)(t.p,{children:"Scores pods based on their KV cache utilization (lower utilization = higher score)."}),"\n",(0,s.jsx)(t.p,{children:"No parameters."}),"\n",(0,s.jsx)(t.h3,{id:"lora-affinity-scorer",children:(0,s.jsx)(t.code,{children:"lora-affinity-scorer"})}),"\n",(0,s.jsx)(t.p,{children:"Scores pods based on LoRA adapter availability and capacity."}),"\n",(0,s.jsx)(t.p,{children:"No parameters."}),"\n",(0,s.jsx)(t.h3,{id:"queue-scorer",children:(0,s.jsx)(t.code,{children:"queue-scorer"})}),"\n",(0,s.jsx)(t.p,{children:"Scores pods based on their waiting queue size (smaller queue = higher score)."}),"\n",(0,s.jsx)(t.p,{children:"No parameters."}),"\n",(0,s.jsx)(t.h3,{id:"running-requests-size-scorer",children:(0,s.jsx)(t.code,{children:"running-requests-size-scorer"})}),"\n",(0,s.jsx)(t.p,{children:"Scores pods based on their number of running requests."}),"\n",(0,s.jsx)(t.p,{children:"No parameters."}),"\n",(0,s.jsx)(t.h3,{id:"prefix-cache-scorer",children:(0,s.jsx)(t.code,{children:"prefix-cache-scorer"})}),"\n",(0,s.jsx)(t.p,{children:"Scores pods based on the length of the prefix match for the request prompt."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"autoTune"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"bool"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"true"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Whether to automatically tune configuration based on metrics."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"blockSize"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"64"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Size of a token block for hashing."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"maxPrefixBlocksToMatch"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"256"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Maximum number of blocks to match for prefix caching."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"lruCapacityPerServer"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"31250"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Estimated LRU capacity per model server (in blocks)."})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"pickers",children:"Pickers"}),"\n",(0,s.jsx)(t.h3,{id:"max-score-picker",children:(0,s.jsx)(t.code,{children:"max-score-picker"})}),"\n",(0,s.jsx)(t.p,{children:"Picks the pod(s) with the maximum score from the list of candidates."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"maxNumOfEndpoints"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"1"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Maximum number of endpoints to pick."})]})})]}),"\n",(0,s.jsx)(t.h3,{id:"random-picker",children:(0,s.jsx)(t.code,{children:"random-picker"})}),"\n",(0,s.jsx)(t.p,{children:"Picks random pod(s) from the candidates."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"maxNumOfEndpoints"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"1"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Maximum number of endpoints to pick."})]})})]}),"\n",(0,s.jsx)(t.h3,{id:"weighted-random-picker",children:(0,s.jsx)(t.code,{children:"weighted-random-picker"})}),"\n",(0,s.jsx)(t.p,{children:"Picks pod(s) based on weighted random sampling derived from their scores."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"maxNumOfEndpoints"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"int"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"1"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Maximum number of endpoints to pick."})]})})]}),"\n",(0,s.jsx)(t.h2,{id:"response-plugins",children:"Response Plugins"}),"\n",(0,s.jsx)(t.h3,{id:"response-header-handler",children:(0,s.jsx)(t.code,{children:"response-header-handler"})}),"\n",(0,s.jsx)(t.p,{children:"Adds serving pod information to the response headers."}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"x-decoder-host-port"}),": Always set to the address and port of the pod that handled the decode phase (the primary target)."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"x-prefiller-host-port"}),": Set to the address and port of the prefill pod, if a separate prefill pod was used (PD disaggregation)."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"No configuration parameters."})]})}function o(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},8453(e,t,l){l.d(t,{R:()=>d,x:()=>r});var i=l(6540);const s={},n=i.createContext(s);function d(e){const t=i.useContext(n);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),i.createElement(n.Provider,{value:t},e.children)}}}]);