"use strict";(self.webpackChunkmif_docs=self.webpackChunkmif_docs||[]).push([[2628],{461(e,r,n){n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>a,toc:()=>h});const a=JSON.parse('{"id":"operations/container-image-caching-with-harbor/index","title":"Container image caching with Harbor","description":"The container images composing the MoAI Inference Framework are distributed through Amazon ECR. Although this approach works well in general, fetching images from a remote registry during deployment and scaling of inference environments may incur substantial delays.","source":"@site/docs/operations/container-image-caching-with-harbor/index.mdx","sourceDirName":"operations/container-image-caching-with-harbor","slug":"/operations/container-image-caching-with-harbor/","permalink":"/dev/operations/container-image-caching-with-harbor/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Container image caching with Harbor","sidebar_position":4,"sidebar_label":"Container image caching (Harbor)"},"sidebar":"docs","previous":{"title":"HF Model Management (PV)","permalink":"/dev/operations/hf-model-management-with-pv"},"next":{"title":"API Reference","permalink":"/dev/reference/heimdall/api-reference"}}');var t=n(4848),s=n(8453),i=n(9489),o=n(7227);const l={title:"Container image caching with Harbor",sidebar_position:4,sidebar_label:"Container image caching (Harbor)"},c=void 0,d={},h=[{value:"Install Harbor",id:"install-harbor",level:2},{value:"HTTP/HTTPS configuration",id:"httphttps-configuration",level:2},{value:"Register Moreh ECR endpoint",id:"register-moreh-ecr-endpoint",level:2},{value:"Create Harbor project",id:"create-harbor-project",level:2},{value:"Configure mirror or rewrite image path",id:"configure-mirror-or-rewrite-image-path",level:2}];function u(e){const r={a:"a",admonition:"admonition",code:"code",h2:"h2",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.p,{children:"The container images composing the MoAI Inference Framework are distributed through Amazon ECR. Although this approach works well in general, fetching images from a remote registry during deployment and scaling of inference environments may incur substantial delays."}),"\n",(0,t.jsxs)(r.p,{children:["This document explains how to build a local image registry with ",(0,t.jsx)(r.a,{href:"https://goharbor.io/",children:"Harbor"}),", automatically cache container images in Moreh's upstream Amazon ECR registry, and use them when deploying production inference environments. It covers the following high-level flow."]}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsx)(r.li,{children:"Installing Harbor and configuring HTTP/HTTPS access."}),"\n",(0,t.jsx)(r.li,{children:"Registering Moreh's Amazon ECR as a registry endpoint in Harbor."}),"\n",(0,t.jsx)(r.li,{children:"Creating a Harbor project to cache or replicate images."}),"\n",(0,t.jsx)(r.li,{children:"Configuring Kubernetes nodes to pull images from Harbor instead of ECR."}),"\n"]}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"install-harbor",children:"Install Harbor"}),"\n",(0,t.jsxs)(r.p,{children:["Refer to ",(0,t.jsx)(r.a,{href:"https://goharbor.io/docs/latest/install-config/",children:"Harbor Installation and Configuration"})," for more details."]}),"\n",(0,t.jsx)(r.p,{children:"Pull a chart from the Harbor Helm repository."}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"helm repo add harbor https://helm.goharbor.io\nhelm repo update harbor\n"})}),"\n",(0,t.jsxs)(r.p,{children:["Decide whether to configure Harbor over HTTP (insecure but simple) or HTTPS, depending on your environment. Then, deploy Harbor using the following command. ",(0,t.jsxs)(r.strong,{children:["If you choose HTTPS, the ",(0,t.jsx)(r.code,{children:"externalURL"})," must start with ",(0,t.jsx)(r.code,{children:"https://"})," instead of ",(0,t.jsx)(r.code,{children:"http://"}),". You also need to replace ",(0,t.jsx)(r.code,{children:"<password>"})," and ",(0,t.jsx)(r.code,{children:"<storageClass>"})," with your own values."]})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",metastring:"{5-10}",children:"helm upgrade -i harbor harbor/harbor \\\n    --version 1.18.2 \\\n    -n harbor \\\n    --create-namespace \\\n    --set harborAdminPassword <password> \\\n    --set persistence.persistentVolumeClaim.registry.storageClass <storageClass> \\\n    --set persistence.persistentVolumeClaim.jobservice.jobLog.storageClass <storageClass> \\\n    --set persistence.persistentVolumeClaim.database.storageClass <storageClass> \\\n    --set persistence.persistentVolumeClaim.redis.storageClass <storageClass> \\\n    --set persistence.persistentVolumeClaim.trivy.storageClass <storageClass> \\\n    --set externalURL http://harbor.harbor.svc.cluster.local \\\n    --set expose.tls.enabled true \\\n    --set expose.tls.certSource secret \\\n    --set expose.tls.secret.secretName harbor-tls\n"})}),"\n",(0,t.jsx)(r.admonition,{type:"info",children:(0,t.jsxs)(r.p,{children:["If you want to modify additional configurations beyond those specified in the command above to better fit your cluster environment, you can customize and use the ",(0,t.jsx)(r.a,{href:"https://github.com/goharbor/harbor-helm/blob/main/values.yaml",children:"values.yaml"})," file provided by Harbor."]})}),"\n",(0,t.jsx)(r.p,{children:"Then, apply additional configuration depending on whether you are using HTTP or HTTPS."}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"httphttps-configuration",children:"HTTP/HTTPS configuration"}),"\n",(0,t.jsx)(r.p,{children:"Harbor can be exposed over HTTP(insecure) or HTTPS. Choose one based on your environment."}),"\n",(0,t.jsxs)(i.A,{children:[(0,t.jsxs)(o.A,{value:"http",label:"HTTP (Default)",default:!0,children:[(0,t.jsx)(r.admonition,{type:"warning",children:(0,t.jsxs)(r.p,{children:["This configuration must be applied to ",(0,t.jsx)(r.strong,{children:"all nodes"}),"."]})}),(0,t.jsxs)(r.p,{children:["If you want to use HTTP, your container runtime must allow an ",(0,t.jsx)(r.strong,{children:"insecure registry"})," for the Harbor endpoint; otherwise image pulls may fail."]}),(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Configure containerd"})}),(0,t.jsx)(r.p,{children:"Configure the registry as insecure:"}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-toml",metastring:'title="/etc/containerd/config.toml"',children:'[plugins]\n...\n  [plugins."io.containerd.cri.v1.images".registry]\n    config_path = "/etc/containerd/certs.d"\n'})}),(0,t.jsx)(r.p,{children:"Create a registry host file."}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"mkdir -p /etc/containerd/certs.d/harbor.harbor.svc.cluster.local:80\n"})}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:'cat > /etc/containerd/certs.d/harbor.harbor.svc.cluster.local:80/hosts.toml << \'EOF\'\nserver = "https://harbor.harbor.svc.cluster.local:80"\n\n[host."http://harbor.harbor.svc.cluster.local:80"]\n  capabilities = ["pull","resolve","push"]\n  skip_verify = true\n  override_path = false\nEOF\n'})}),(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Restart containerd"})}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"sudo systemctl restart containerd\n"})})]}),(0,t.jsxs)(o.A,{value:"https",label:"HTTPS",children:[(0,t.jsx)(r.p,{children:"Configure TLS for Harbor using either:"}),(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"a public certificate, or"}),"\n",(0,t.jsx)(r.li,{children:"an internal CA / self-signed certificate (ensure the CA is trusted by clients)."}),"\n"]}),(0,t.jsxs)(r.p,{children:["If you expose Harbor with Ingress, you can terminate TLS at the ingress controller and route traffic to Harbor services. If you use a self-signed certificate, make sure Kubernetes nodes (container runtime) trust the CA certificate; otherwise image pulls may fail with x509 errors.\nIn this document we use ",(0,t.jsx)(r.code,{children:"ClusterIP"})," and issue certificates with ",(0,t.jsx)(r.a,{href:"/dev/getting-started/prerequisites#cert-manager",children:"cert-manager"}),"."]}),(0,t.jsx)(r.admonition,{type:"warning",children:(0,t.jsx)(r.p,{children:"If you use this approach, make sure to account for certificate expiration."})}),(0,t.jsx)(r.p,{children:"Following manifest creates root CA(harbor-ca) and TLS certificate(harbor-tls)."}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",metastring:'title="harbor-tls.yaml"',children:"---\napiVersion: cert-manager.io/v1\nkind: Issuer\nmetadata:\n  name: harbor-selfsigned\n  namespace: harbor\nspec:\n  selfSigned: {}\n\n---\napiVersion: cert-manager.io/v1\nkind: Certificate\nmetadata:\n  name: harbor-ca\n  namespace: harbor\nspec:\n  isCA: true\n  commonName: harbor-ca\n  secretName: harbor-ca\n  privateKey:\n    algorithm: RSA\n    size: 2048\n  issuerRef:\n    name: harbor-selfsigned\n    kind: Issuer\n\n---\napiVersion: cert-manager.io/v1\nkind: Issuer\nmetadata:\n  name: harbor-ca-issuer\n  namespace: harbor\nspec:\n  ca:\n    secretName: harbor-ca\n\n---\napiVersion: cert-manager.io/v1\nkind: Certificate\nmetadata:\n  name: harbor-tls\n  namespace: harbor\nspec:\n  secretName: harbor-tls\n  commonName: harbor.harbor.svc.cluster.local\n  dnsNames:\n    - harbor.harbor.svc.cluster.local\n    - harbor\n    - harbor.harbor\n  privateKey:\n    algorithm: RSA\n    size: 2048\n  issuerRef:\n    name: harbor-ca-issuer\n    kind: Issuer\n"})}),(0,t.jsx)(r.p,{children:"Then create certificates with following command."}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"kubectl apply -f harbor-tls.yaml\n"})}),(0,t.jsx)(r.p,{children:"Confirm resources are ready."}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"kubectl -n harbor get issuer,certificate\nkubectl -n harbor describe certificate harbor-tls\nkubectl -n harbor get secret harbor-tls\n"})}),(0,t.jsx)(r.admonition,{type:"warning",children:(0,t.jsxs)(r.p,{children:["This configuration must be applied to ",(0,t.jsx)(r.strong,{children:"all nodes"}),"."]})}),(0,t.jsx)(r.p,{children:"Extract the root CA from the secret and add it to containerd's trust store."}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"kubectl get secret -n harbor harbor-ca -o jsonpath='{.data.ca\\.crt}' | base64 -d > harbor-ca.crt\n"})}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"mkdir -p /etc/containerd/certs.d/harbor.harbor.svc.cluster.local:443\n"})}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"cp harbor-ca.crt /etc/containerd/certs.d/harbor.harbor.svc.cluster.local:443/ca.crt\n"})}),(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Create a registry host file"})}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:'cat > /etc/containerd/certs.d/harbor.harbor.svc.cluster.local:443/hosts.toml << \'EOF\'\nserver = "https://harbor.harbor.svc.cluster.local:443"\n\n[host."https://harbor.harbor.svc.cluster.local:443"]\n  capabilities = ["pull","resolve","push"]\n  ca = "/etc/containerd/certs.d/harbor.harbor.svc.cluster.local:443/ca.crt"\n  override_path = false\nEOF\n'})}),(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Restart containerd"})}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"sudo systemctl restart containerd\n"})})]})]}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"register-moreh-ecr-endpoint",children:"Register Moreh ECR endpoint"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Administration"})," > ",(0,t.jsx)(r.strong,{children:"Registries"})," > ",(0,t.jsx)(r.strong,{children:"New Endpoint"})]}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Provider: AWS ECR"}),"\n",(0,t.jsxs)(r.li,{children:["Endpoint URL: ",(0,t.jsx)(r.code,{children:"https://255250787067.dkr.ecr.ap-northeast-2.amazonaws.com"})]}),"\n",(0,t.jsxs)(r.li,{children:["Please refer to ",(0,t.jsx)(r.a,{href:"/dev/getting-started/prerequisites#moai-inference-framework",children:"moai-inference-framework"})," for the ",(0,t.jsx)(r.code,{children:"Access ID"})," and ",(0,t.jsx)(r.code,{children:"Access Secret"}),"."]}),"\n"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{alt:"Create New Endpoint",src:n(9248).A+"",width:"1494",height:"1362"})}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"create-harbor-project",children:"Create Harbor project"}),"\n",(0,t.jsxs)(i.A,{children:[(0,t.jsxs)(o.A,{value:"proxy-cache",label:"Proxy cache (Default)",default:!0,children:[(0,t.jsx)(r.p,{children:"This approach makes the container runtime pull images through Harbor as a proxy (pull-through cache). Images are cached on demand when they are first pulled."}),(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Create a project"})}),(0,t.jsxs)(r.p,{children:["Create a new Harbor project and enable ",(0,t.jsx)(r.strong,{children:"Proxy cache"}),"."]}),(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{alt:"Create New Project as Proxy",src:n(449).A+"",width:"1500",height:"1276"})})]}),(0,t.jsxs)(o.A,{value:"replication",label:"Replication",children:[(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Create a project"})}),(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Projects"})," > ",(0,t.jsx)(r.strong,{children:"New Project"})]}),(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{alt:"Create New Project",src:n(6430).A+"",width:"1492",height:"1284"})}),(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Create a Harbor replication rule"})}),(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Administration"})," > ",(0,t.jsx)(r.strong,{children:"Replications"})," > ",(0,t.jsx)(r.strong,{children:"New Replication Rule"})]}),(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{alt:"Create New Replication Rule",src:n(3376).A+"",width:"1556",height:"1546"})}),(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Replication rule must be triggered to mirror images from ECR into Harbor project."})})]})]}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"configure-mirror-or-rewrite-image-path",children:"Configure mirror or rewrite image path"}),"\n",(0,t.jsxs)(i.A,{children:[(0,t.jsxs)(o.A,{value:"containerd-mirror",label:"Containerd mirror (Default)",default:!0,children:[(0,t.jsx)(r.admonition,{type:"warning",children:(0,t.jsxs)(r.p,{children:["This configuration must be applied to ",(0,t.jsx)(r.strong,{children:"all nodes"}),"."]})}),(0,t.jsxs)(r.p,{children:["On every node that may pull images, create the directory and ",(0,t.jsx)(r.code,{children:"hosts.toml"})," file below."]}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"sudo mkdir -p /etc/containerd/certs.d/255250787067.dkr.ecr.ap-northeast-2.amazonaws.com\n"})}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",metastring:"{4}",children:'sudo tee /etc/containerd/certs.d/255250787067.dkr.ecr.ap-northeast-2.amazonaws.com/hosts.toml >/dev/null <<\'EOF\'\nserver = "https://255250787067.dkr.ecr.ap-northeast-2.amazonaws.com"\n\n# [host."https://harbor.harbor.svc.cluster.local:443/v2/mif"]\n[host."http://harbor.harbor.svc.cluster.local:80/v2/mif"]\n  capabilities = ["pull","resolve"]\n  skip_verify = true\n  override_path = false\nEOF\n'})}),(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Restart containerd"})}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"sudo systemctl restart containerd\n"})}),(0,t.jsx)(r.p,{children:"For verifying, Pull an image once from any node configured and then confirm the image cached under the proxy cache project(mif) in Harbor web UI."}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"sudo crictl pull \\\n  255250787067.dkr.ecr.ap-northeast-2.amazonaws.com/quickstart/<image>:<tag>\n"})})]}),(0,t.jsxs)(o.A,{value:"kyverno-rewrite",label:"Kyverno rewrite",children:[(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.a,{href:"https://kyverno.io/docs/introduction/",children:"Kyverno"})," is Kubernetes-native policy engine that enforces guardrails and automates operations using policy-as-code (YAML). It runs as a dynamic admission controller, evaluating requests sent to the Kubernetes API server and can ",(0,t.jsx)(r.code,{children:"validate"})," or ",(0,t.jsx)(r.code,{children:"mutate"})," resources at admission time."]}),(0,t.jsx)(r.p,{children:"Kyverno can be used to rewrite container image references so that workloads which originally point to Amazon ECR will instead pull images from your local Harbor registry (after you mirror the images to Harbor)."}),(0,t.jsxs)(r.p,{children:["Deploy ",(0,t.jsx)(r.code,{children:"kyverno"})," using the following command:"]}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"kubectl create -f https://github.com/kyverno/kyverno/releases/latest/download/install.yaml\n"})}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",metastring:'{21,36} title="clusterpolicy.yaml"',children:'apiVersion: kyverno.io/v1\nkind: ClusterPolicy\nmetadata:\n  name: ecr-rewrite-registry\nspec:\n  admission: true\n  background: true\n  emitWarning: false\n  rules:\n    - match:\n        any:\n          - resources:\n              kinds:\n                - Pod\n      mutate:\n        foreach:\n          - list: request.object.spec.containers\n            patchStrategicMerge:\n              spec:\n                containers: # set registry port as your setup (80 or 443)\n                  - image: \'{{ regex_replace_all_literal("255250787067.dkr.ecr.ap-northeast-2.amazonaws.com", "{{ element.image }}, "harbor.harbor.svc.cluster.local:<yourPort>/mif") }}\'\n                    name: \'{{ element.name }}\'\n      name: ecr-rewrite-registry-container\n      skipBackgroundRequests: true\n    - match:\n        any:\n          - resources:\n              kinds:\n                - Pod\n      mutate:\n        foreach:\n          - list: request.object.spec.initContainers\n            patchStrategicMerge:\n              spec:\n                initContainers: # set registry port as your setup (80 or 443)\n                  - image: \'{{ regex_replace_all_literal("255250787067.dkr.ecr.ap-northeast-2.amazonaws.com", "{{ element.image }}, "harbor.harbor.svc.cluster.local:<yourPort>/mif") }}\'\n                    name: \'{{ element.name }}\'\n      name: ecr-rewrite-registry-init-container\n      preconditions:\n        all:\n          - key: \'{{ request.object.spec.initContainers[] || `[]` | length(@) }}\n            operator: GreaterThanOrEquals\n            value: 1\n      skipBackgroundRequests: true\n  validationFailureAction: Audit\n'})}),(0,t.jsxs)(r.p,{children:["Create a ",(0,t.jsx)(r.code,{children:"ClusterPolicy"}),":"]}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"kubectl apply -f clusterpolicy.yaml\n"})}),(0,t.jsx)(r.p,{children:"If you want to check policy status, then follow this command."}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"kubectl get clusterpolicy\n"})}),(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"NAME                   ADMISSION   BACKGROUND   READY   AGE   MESSAGE\necr-rewrite-registry   true        true         True    19h   Ready\n"})})]})]})]})}function p(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},7227(e,r,n){n.d(r,{A:()=>i});n(6540);var a=n(4164);const t="tabItem_Ymn6";var s=n(4848);function i(e){var r=e.children,n=e.hidden,i=e.className;return(0,s.jsx)("div",{role:"tabpanel",className:(0,a.A)(t,i),hidden:n,children:r})}},9489(e,r,n){n.d(r,{A:()=>k});var a=n(6540),t=n(4164),s=n(8630),i=n(4245),o=n(6347),l=n(6494),c=n(2814),d=n(5167),h=n(9900);function u(e){var r,n;return null!=(r=null==(n=a.Children.toArray(e).filter(function(e){return"\n"!==e}).map(function(e){if(!e||(0,a.isValidElement)(e)&&((r=e.props)&&"object"==typeof r&&"value"in r))return e;var r;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')}))?void 0:n.filter(Boolean))?r:[]}function p(e){var r=e.values,n=e.children;return(0,a.useMemo)(function(){var e=null!=r?r:function(e){return u(e).map(function(e){var r=e.props;return{value:r.value,label:r.label,attributes:r.attributes,default:r.default}})}(n);return function(e){var r=(0,d.XI)(e,function(e,r){return e.value===r.value});if(r.length>0)throw new Error('Docusaurus error: Duplicate values "'+r.map(function(e){return e.value}).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e},[r,n])}function m(e){var r=e.value;return e.tabValues.some(function(e){return e.value===r})}function g(e){var r=e.queryString,n=void 0!==r&&r,t=e.groupId,s=(0,o.W6)(),i=function(e){var r=e.queryString,n=void 0!==r&&r,a=e.groupId;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=a?a:null}({queryString:n,groupId:t});return[(0,c.aZ)(i),(0,a.useCallback)(function(e){if(i){var r=new URLSearchParams(s.location.search);r.set(i,e),s.replace(Object.assign({},s.location,{search:r.toString()}))}},[i,s])]}function b(e){var r,n,t,s,i=e.defaultValue,o=e.queryString,c=void 0!==o&&o,d=e.groupId,u=p(e),b=(0,a.useState)(function(){return function(e){var r,n=e.defaultValue,a=e.tabValues;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!m({value:n,tabValues:a}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+n+'" but none of its children has the corresponding value. Available values are: '+a.map(function(e){return e.value}).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return n}var t=null!=(r=a.find(function(e){return e.default}))?r:a[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:i,tabValues:u})}),f=b[0],x=b[1],j=g({queryString:c,groupId:d}),v=j[0],y=j[1],w=(r=function(e){return e?"docusaurus.tab."+e:null}({groupId:d}.groupId),n=(0,h.Dv)(r),t=n[0],s=n[1],[t,(0,a.useCallback)(function(e){r&&s.set(e)},[r,s])]),C=w[0],k=w[1],A=function(){var e=null!=v?v:C;return m({value:e,tabValues:u})?e:null}();return(0,l.A)(function(){A&&x(A)},[A]),{selectedValue:f,selectValue:(0,a.useCallback)(function(e){if(!m({value:e,tabValues:u}))throw new Error("Can't select invalid tab value="+e);x(e),y(e),k(e)},[y,k,u]),tabValues:u}}var f=n(1062);const x="tabList__CuJ",j="tabItem_LNqP";var v=n(4848);function y(e){var r=e.className,n=e.block,a=e.selectedValue,s=e.selectValue,o=e.tabValues,l=[],c=(0,i.a_)().blockElementScrollPositionUntilNextRender,d=function(e){var r=e.currentTarget,n=l.indexOf(r),t=o[n].value;t!==a&&(c(r),s(t))},h=function(e){var r,n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":var a,t=l.indexOf(e.currentTarget)+1;n=null!=(a=l[t])?a:l[0];break;case"ArrowLeft":var s,i=l.indexOf(e.currentTarget)-1;n=null!=(s=l[i])?s:l[l.length-1]}null==(r=n)||r.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":n},r),children:o.map(function(e){var r=e.value,n=e.label,s=e.attributes;return(0,v.jsx)("li",Object.assign({role:"tab",tabIndex:a===r?0:-1,"aria-selected":a===r,ref:function(e){l.push(e)},onKeyDown:h,onClick:d},s,{className:(0,t.A)("tabs__item",j,null==s?void 0:s.className,{"tabs__item--active":a===r}),children:null!=n?n:r}),r)})})}function w(e){var r=e.lazy,n=e.children,s=e.selectedValue,i=(Array.isArray(n)?n:[n]).filter(Boolean);if(r){var o=i.find(function(e){return e.props.value===s});return o?(0,a.cloneElement)(o,{className:(0,t.A)("margin-top--md",o.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:i.map(function(e,r){return(0,a.cloneElement)(e,{key:r,hidden:e.props.value!==s})})})}function C(e){var r=b(e);return(0,v.jsxs)("div",{className:(0,t.A)(s.G.tabs.container,"tabs-container",x),children:[(0,v.jsx)(y,Object.assign({},r,e)),(0,v.jsx)(w,Object.assign({},r,e))]})}function k(e){var r=(0,f.A)();return(0,v.jsx)(C,Object.assign({},e,{children:u(e.children)}),String(r))}},6430(e,r,n){n.d(r,{A:()=>a});const a=n.p+"assets/images/project-4b9af5e637580307f57df22eda676678.png"},449(e,r,n){n.d(r,{A:()=>a});const a=n.p+"assets/images/proxy-project-65b8238014a970240035171c3535ea4a.png"},9248(e,r,n){n.d(r,{A:()=>a});const a=n.p+"assets/images/registry-endpoint-6ede649942defe6b52cb84b5efc0d00c.png"},3376(e,r,n){n.d(r,{A:()=>a});const a=n.p+"assets/images/replication-rule-53eeaebfc4c1dfeb0509b03cc399dd73.png"},8453(e,r,n){n.d(r,{R:()=>i,x:()=>o});var a=n(6540);const t={},s=a.createContext(t);function i(e){const r=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),a.createElement(s.Provider,{value:r},e.children)}}}]);